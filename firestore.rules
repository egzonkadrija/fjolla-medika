rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    match /appointments/{appointmentId} {
      // Anyone can read (clients check slot availability)
      allow read: if true;

      // Anyone can create, but only with status "pending"
      allow create: if request.resource.data.status == "pending"
                    && request.resource.data.keys().hasAll(['date', 'time', 'name', 'phone', 'status', 'createdAt']);

      // Only authenticated users (admin) can update or delete
      allow update, delete: if request.auth != null;
    }
  }
}
